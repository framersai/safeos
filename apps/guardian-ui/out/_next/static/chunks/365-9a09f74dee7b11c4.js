"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{26435:function(e,t,i){i.d(t,{zn:function(){return a}});var o=i(2265);class n{getIsSupported(){return this.isSupported}getPermission(){return this.permission}async requestPermission(){if(!this.isSupported)return"denied";try{let e=await Notification.requestPermission();return this.permission=e,this.permission}catch(e){return console.error("Failed to request notification permission:",e),"denied"}}async registerServiceWorker(){if(!("serviceWorker"in navigator))return!1;try{return this.serviceWorkerRegistration=await navigator.serviceWorker.ready,!0}catch(e){return console.error("Failed to get service worker registration:",e),!1}}async show(e){var t,i;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.isSupported||"granted"!==this.permission)return console.warn("Notifications not permitted"),null;let s={body:o.body,icon:o.icon||this.defaultIcon,badge:o.badge||this.defaultBadge,tag:o.tag,requireInteraction:null!==(t=o.requireInteraction)&&void 0!==t&&t,silent:null!==(i=o.silent)&&void 0!==i&&i,data:o.data};o.vibrate&&"vibrate"in navigator&&(s.vibrate=o.vibrate),o.image&&(s.image=o.image);try{let t=new Notification(e,s);return o.tag&&this.activeNotifications.set(o.tag,t),t.onclick=e=>{e.preventDefault(),window.focus(),t.close(),n.onClick&&n.onClick(t)},t.onclose=()=>{o.tag&&this.activeNotifications.delete(o.tag),n.onClose&&n.onClose(t)},t.onerror=e=>{console.error("Notification error:",e),n.onError&&n.onError(Error("Notification failed"))},t}catch(e){return console.error("Failed to show notification:",e),n.onError&&n.onError(e),null}}async showAlert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i="SafeOS Alert: ".concat({info:"\uD83D\uDD35",low:"\uD83D\uDFE2",medium:"\uD83D\uDFE1",high:"\uD83D\uDFE0",critical:"\uD83D\uDD34"}[e.severity]," ").concat(e.severity.toUpperCase());return this.show(i,{body:e.message,icon:this.defaultIcon,tag:"alert-".concat(e.id),requireInteraction:"critical"===e.severity||"high"===e.severity,image:e.thumbnailUrl,data:{alertId:e.id,severity:e.severity},vibrate:"critical"===e.severity?[200,100,200,100,200]:void 0},{onClick:e=>{"/monitor"!==window.location.pathname&&(window.location.href="/monitor"),t.onClick&&t.onClick(e)},onClose:t.onClose,onError:t.onError})}async showEmergency(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.show("\uD83D\uDEA8 EMERGENCY ALERT \uD83D\uDEA8",{body:"CRITICAL: ".concat(e.message,". Immediate attention required!"),icon:this.defaultIcon,tag:"emergency-".concat(e.id),requireInteraction:!0,image:e.thumbnailUrl,data:{alertId:e.id,severity:"emergency"},vibrate:[500,200,500,200,500,200,500]},{onClick:e=>{window.focus(),"/monitor"!==window.location.pathname&&(window.location.href="/monitor"),t.onClick&&t.onClick(e)},onClose:t.onClose,onError:t.onError})}async notify(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.show(e,{body:t,...i})}close(e){let t=this.activeNotifications.get(e);t&&(t.close(),this.activeNotifications.delete(e))}closeAll(){this.activeNotifications.forEach(e=>{e.close()}),this.activeNotifications.clear()}getActiveCount(){return this.activeNotifications.size}isActive(e){return this.activeNotifications.has(e)}constructor(){this.permission="default",this.activeNotifications=new Map,this.serviceWorkerRegistration=null,this.isSupported=!1,this.defaultIcon="/logo.svg",this.defaultBadge="/favicon.svg","Notification"in window&&(this.isSupported=!0,this.permission=Notification.permission)}}let s=null;function a(){let[e,t]=(0,o.useState)("default"),[i,a]=(0,o.useState)(!1),l=(s||(s=new n),s);(0,o.useEffect)(()=>{a(l.getIsSupported()),t(l.getPermission())},[]);let r=(0,o.useCallback)(async()=>{let e=await l.requestPermission();return t(e),e},[]),c=(0,o.useCallback)((e,t)=>l.showAlert(e,t),[]),d=(0,o.useCallback)((e,t)=>l.showEmergency(e,t),[]);return{permission:e,isSupported:i,isGranted:"granted"===e,isDenied:"denied"===e,requestPermission:r,showAlert:c,showEmergency:d,notify:(0,o.useCallback)((e,t,i)=>l.notify(e,t,i),[]),close:(0,o.useCallback)(e=>{l.close(e)},[]),closeAll:(0,o.useCallback)(()=>{l.closeAll()},[]),getActiveCount:()=>l.getActiveCount(),isActive:e=>l.isActive(e)}}},66454:function(e,t,i){i.d(t,{Z:function(){return c}});var o=i(2265);let n={notification:{type:"notification",path:"/sounds/notification.mp3",defaultVolume:60,priority:1,loop:!1,fadeIn:100,fadeOut:200},alert:{type:"alert",path:"/sounds/alert.mp3",defaultVolume:70,priority:2,loop:!1,fadeIn:50,fadeOut:150},warning:{type:"warning",path:"/sounds/warning.mp3",defaultVolume:80,priority:3,loop:!1,fadeIn:0,fadeOut:100},alarm:{type:"alarm",path:"/sounds/alarm.mp3",defaultVolume:90,priority:4,loop:!0,fadeIn:0,fadeOut:0},emergency:{type:"emergency",path:"/sounds/emergency.mp3",defaultVolume:100,priority:5,loop:!0,fadeIn:0,fadeOut:0}},s={low:"notification",medium:"alert",high:"warning",critical:"alarm"},a={low:.6,medium:.7,high:.9,critical:1};class l{async initialize(){if(this.isInitialized)return;let e=Object.values(n).map(async e=>{try{let t=new Audio(e.path);t.preload="auto",t.load(),this.preloadedAudio.set(e.type,t)}catch(t){console.warn("Failed to preload sound: ".concat(e.type),t)}});await Promise.all(e),this.isInitialized=!0}setUserVolume(e){this.userVolume=Math.max(0,Math.min(100,e)),this.activeSounds.forEach(e=>{"emergency"===e.type||this.emergencyModeActive||(e.audio.volume=this.calculateVolume(e.type))})}getUserVolume(){return this.userVolume}setGlobalMute(e){this.globalMute=e,this.activeSounds.forEach(t=>{"emergency"!==t.type&&(t.audio.muted=e)})}isGlobalMuted(){return this.globalMute}setEmergencyMode(e){this.emergencyModeActive=e,e?this.activeSounds.forEach(e=>{e.audio.volume=1,e.audio.muted=!1}):this.activeSounds.forEach(e=>{e.audio.volume=this.calculateVolume(e.type),this.globalMute&&"emergency"!==e.type&&(e.audio.muted=!0)})}isEmergencyModeActive(){return this.emergencyModeActive}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n[e],o="".concat(e,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),s=new Audio(i.path),a=this.calculateVolume(e,t.volume);(t.forceMaxVolume||this.emergencyModeActive||"emergency"===e)&&(a=1),s.volume=a,s.loop=void 0!==t.loop?t.loop:i.loop,this.globalMute&&"emergency"!==e&&!this.emergencyModeActive&&(s.muted=!0),this.handlePriority(i.priority);let l={id:o,type:e,audio:s,priority:i.priority,startTime:Date.now(),loop:s.loop,onEnd:t.onEnd};this.activeSounds.set(o,l);let r=void 0!==t.fadeIn?t.fadeIn:i.fadeIn;return r>0&&(s.volume=0,this.fadeVolume(s,0,a,r)),s.addEventListener("ended",()=>{!s.loop&&(this.activeSounds.delete(o),t.onEnd&&t.onEnd())}),s.play().catch(e=>{console.warn("Failed to play sound:",e),this.activeSounds.delete(o)}),o}playForSeverity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=s[e],o=a[e];return this.play(i,{...t,volume:void 0!==t.volume?t.volume:this.userVolume*o})}startEmergencyAlarm(){return this.setEmergencyMode(!0),this.play("emergency",{loop:!0,forceMaxVolume:!0})}stopEmergencyAlarm(){this.activeSounds.forEach((e,t)=>{"emergency"===e.type&&this.stop(t)}),this.setEmergencyMode(!1)}stop(e,t){let i=this.activeSounds.get(e);if(!i)return;let o=n[i.type],s=void 0!==t?t:o.fadeOut;s>0?this.fadeVolume(i.audio,i.audio.volume,0,s,()=>{i.audio.pause(),i.audio.currentTime=0,this.activeSounds.delete(e)}):(i.audio.pause(),i.audio.currentTime=0,this.activeSounds.delete(e))}stopByType(e){this.activeSounds.forEach((t,i)=>{t.type===e&&this.stop(i)})}stopAll(){this.activeSounds.forEach((e,t)=>{this.stop(t,0)})}getActiveSounds(){return Array.from(this.activeSounds.values())}isPlaying(){return this.activeSounds.size>0}isPlayingType(e){return Array.from(this.activeSounds.values()).some(t=>t.type===e)}test(e){return this.play(e,{loop:!1,fadeIn:0,fadeOut:200})}testEmergency(){this.startEmergencyAlarm(),setTimeout(()=>{this.stopEmergencyAlarm()},2e3)}calculateVolume(e,t){if(this.emergencyModeActive)return 1;let i=n[e];return Math.max(void 0!==t?t:this.userVolume,{1:0,2:0,3:30,4:50,5:100}[i.priority]||0)/100}handlePriority(e){if(this.activeSounds.size>=3){let t=1/0,i=null;this.activeSounds.forEach((o,n)=>{o.priority<t&&o.priority<e&&(t=o.priority,i=n)}),i&&this.stop(i,0)}}fadeVolume(e,t,i,o,n){let s=(i-t)/20,a=0;e.volume=t;let l=setInterval(()=>{a++,e.volume=Math.max(0,Math.min(1,t+s*a)),a>=20&&(clearInterval(l),e.volume=i,n&&n())},o/20)}constructor(){this.activeSounds=new Map,this.preloadedAudio=new Map,this.userVolume=70,this.globalMute=!1,this.emergencyModeActive=!1,this.isInitialized=!1}}let r=null;function c(){let[e,t]=(0,o.useState)(!1),[i,n]=(0,o.useState)(70),[s,a]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1),u=(r||(r=new l),r);(0,o.useEffect)(()=>{(async()=>{await u.initialize(),t(!0),n(u.getUserVolume()),a(u.isGlobalMuted()),d(u.isEmergencyModeActive())})()},[]);let m=(0,o.useCallback)(e=>{u.setUserVolume(e),n(e)},[]),g=(0,o.useCallback)(()=>{let e=!u.isGlobalMuted();u.setGlobalMute(e),a(e)},[]),h=(0,o.useCallback)((e,t)=>u.play(e,t),[]),p=(0,o.useCallback)((e,t)=>u.playForSeverity(e,t),[]),v=(0,o.useCallback)(()=>(d(!0),u.startEmergencyAlarm()),[]),y=(0,o.useCallback)(()=>{d(!1),u.stopEmergencyAlarm()},[]),f=(0,o.useCallback)(e=>{u.stop(e)},[]);return{isInitialized:e,volume:i,muted:s,emergencyMode:c,updateVolume:m,toggleMute:g,play:h,playForSeverity:p,startEmergency:v,stopEmergency:y,stop:f,stopAll:(0,o.useCallback)(()=>{u.stopAll()},[]),test:(0,o.useCallback)(e=>u.test(e),[]),testEmergency:(0,o.useCallback)(()=>{u.testEmergency()},[]),isPlaying:()=>u.isPlaying(),getActiveSounds:()=>u.getActiveSounds()}}},27454:function(e,t,i){i.d(t,{F2:function(){return r},Km:function(){return a},pP:function(){return s}});var o=i(59625),n=i(89134);let s={silent:{id:"silent",name:"Silent Mode",description:"All sounds off, visual alerts only. Perfect for quiet environments.",motionSensitivity:50,audioSensitivity:50,pixelThreshold:30,absolutePixelThreshold:100,analysisInterval:10,alertDelay:60,alertVolume:0,emergencyMode:!1,pixelDetectionEnabled:!1,motionDetectionEnabled:!0,audioDetectionEnabled:!0,processingMode:"local",useAbsoluteThreshold:!1},night:{id:"night",name:"Night Mode",description:"Reduced sensitivity, lower volume (50%), longer intervals for sleeping.",motionSensitivity:40,audioSensitivity:60,pixelThreshold:40,absolutePixelThreshold:150,analysisInterval:15,alertDelay:120,alertVolume:50,emergencyMode:!1,pixelDetectionEnabled:!1,motionDetectionEnabled:!0,audioDetectionEnabled:!0,processingMode:"local",useAbsoluteThreshold:!1},maximum:{id:"maximum",name:"Maximum Alert",description:"High sensitivity (80%), max volume, 5-second intervals.",motionSensitivity:80,audioSensitivity:80,pixelThreshold:20,absolutePixelThreshold:50,analysisInterval:5,alertDelay:30,alertVolume:100,emergencyMode:!1,pixelDetectionEnabled:!0,motionDetectionEnabled:!0,audioDetectionEnabled:!0,processingMode:"hybrid",useAbsoluteThreshold:!1},ultimate:{id:"ultimate",name:"Ultimate Secure",description:"Emergency mode ON, max everything (100%), 2-second intervals, all detection enabled.",motionSensitivity:100,audioSensitivity:100,pixelThreshold:10,absolutePixelThreshold:20,analysisInterval:2,alertDelay:10,alertVolume:100,emergencyMode:!0,pixelDetectionEnabled:!0,motionDetectionEnabled:!0,audioDetectionEnabled:!0,processingMode:"hybrid",useAbsoluteThreshold:!0},infant_sleep:{id:"infant_sleep",name:"Infant Sleep Monitor",description:"Ultra-sensitive: 5px movement triggers alert. 100% local, instant response. For co-sleeping or nearby infant monitoring.",motionSensitivity:98,audioSensitivity:95,pixelThreshold:2,absolutePixelThreshold:5,analysisInterval:1,alertDelay:0,alertVolume:100,emergencyMode:!1,pixelDetectionEnabled:!0,motionDetectionEnabled:!0,audioDetectionEnabled:!0,processingMode:"local",useAbsoluteThreshold:!0},pet_sleep:{id:"pet_sleep",name:"Pet Sleep Monitor",description:"Sensitive: 10px movement triggers alert. For monitoring sleeping pets. 100% local processing.",motionSensitivity:90,audioSensitivity:70,pixelThreshold:5,absolutePixelThreshold:10,analysisInterval:2,alertDelay:5,alertVolume:80,emergencyMode:!1,pixelDetectionEnabled:!0,motionDetectionEnabled:!0,audioDetectionEnabled:!1,processingMode:"local",useAbsoluteThreshold:!0},deep_sleep_minimal:{id:"deep_sleep_minimal",name:"Deep Sleep Ultra-Sensitive",description:"Maximum sensitivity: 3px triggers alert. For critical monitoring where any movement matters. Zero latency.",motionSensitivity:100,audioSensitivity:100,pixelThreshold:1,absolutePixelThreshold:3,analysisInterval:1,alertDelay:0,alertVolume:100,emergencyMode:!0,pixelDetectionEnabled:!0,motionDetectionEnabled:!0,audioDetectionEnabled:!0,processingMode:"local",useAbsoluteThreshold:!0},custom:{id:"custom",name:"Custom",description:"Your personalized settings.",motionSensitivity:50,audioSensitivity:50,pixelThreshold:30,absolutePixelThreshold:100,analysisInterval:10,alertDelay:60,alertVolume:70,emergencyMode:!1,pixelDetectionEnabled:!1,motionDetectionEnabled:!0,audioDetectionEnabled:!0,processingMode:"local",useAbsoluteThreshold:!1}},a={infant_sleep:s.infant_sleep,pet_sleep:s.pet_sleep,deep_sleep_minimal:s.deep_sleep_minimal},l=[{id:"full",name:"Full Screen",enabled:!0,x:0,y:0,width:100,height:100},{id:"center",name:"Center Focus",enabled:!1,x:25,y:25,width:50,height:50},{id:"left",name:"Left Side",enabled:!1,x:0,y:0,width:50,height:100},{id:"right",name:"Right Side",enabled:!1,x:50,y:0,width:50,height:100}],r=(0,o.Ue)()((0,n.tJ)((e,t)=>({activePresetId:"maximum",activeSleepPreset:null,globalSettings:{...s.maximum},scenarioOverrides:{},detectionZones:[...l],audioSettings:{frequencyRange:"all",backgroundNoiseFilter:!0,customLowFreq:20,customHighFreq:2e4},timingSettings:{cooldownPeriod:30,minimumMotionDuration:500,emergencyEscalationDelay:300},emergencyModeActive:!1,emergencyAlertId:null,globalMute:!1,customPresets:[],setActivePreset:i=>{let o="custom"===i?t().globalSettings:s[i],n=["infant_sleep","pet_sleep","deep_sleep_minimal"].includes(i)?i:null;e({activePresetId:i,activeSleepPreset:n,globalSettings:{...o,id:i}})},activateSleepMode:t=>{let i=a[t];e({activePresetId:t,activeSleepPreset:t,globalSettings:{...i}})},deactivateSleepMode:()=>{e({activePresetId:"maximum",activeSleepPreset:null,globalSettings:{...s.maximum}})},updateGlobalSettings:t=>{e(e=>({activePresetId:"custom",globalSettings:{...e.globalSettings,...t,id:"custom"}}))},setScenarioOverride:(t,i)=>{e(e=>({scenarioOverrides:{...e.scenarioOverrides,[t]:i}}))},getEffectiveSettings:e=>{let i=t(),o=i.globalSettings;return e&&i.scenarioOverrides[e]?{...o,...i.scenarioOverrides[e]}:o},updateDetectionZone:(t,i)=>{e(e=>({detectionZones:e.detectionZones.map(e=>e.id===t?{...e,...i}:e)}))},addDetectionZone:t=>{let i="custom-".concat(Date.now());e(e=>({detectionZones:[...e.detectionZones,{...t,id:i}]}))},removeDetectionZone:t=>{e(e=>({detectionZones:e.detectionZones.filter(e=>e.id!==t)}))},updateAudioSettings:t=>{e(e=>({audioSettings:{...e.audioSettings,...t}}))},updateTimingSettings:t=>{e(e=>({timingSettings:{...e.timingSettings,...t}}))},activateEmergencyMode:t=>{e({emergencyModeActive:!0,emergencyAlertId:t})},deactivateEmergencyMode:()=>{e({emergencyModeActive:!1,emergencyAlertId:null})},toggleGlobalMute:()=>{e(e=>({globalMute:!e.globalMute}))},setGlobalMute:t=>{e({globalMute:t})},saveCustomPreset:(i,o)=>{let n={...t().globalSettings,id:"custom-".concat(Date.now()),name:i,description:o};e(e=>({customPresets:[...e.customPresets,n]}))},loadCustomPreset:i=>{let o=t().customPresets.find(e=>e.id===i);o&&e({activePresetId:"custom",globalSettings:{...o}})},deleteCustomPreset:t=>{e(e=>({customPresets:e.customPresets.filter(e=>e.id!==t)}))},exportSettings:()=>{let e=t();return JSON.stringify({activePresetId:e.activePresetId,globalSettings:e.globalSettings,scenarioOverrides:e.scenarioOverrides,detectionZones:e.detectionZones,audioSettings:e.audioSettings,timingSettings:e.timingSettings,customPresets:e.customPresets},null,2)},importSettings:i=>{try{let o=JSON.parse(i);return e({activePresetId:o.activePresetId||"maximum",globalSettings:o.globalSettings||s.maximum,scenarioOverrides:o.scenarioOverrides||{},detectionZones:o.detectionZones||l,audioSettings:o.audioSettings||t().audioSettings,timingSettings:o.timingSettings||t().timingSettings,customPresets:o.customPresets||[]}),!0}catch(e){return!1}},resetToDefaults:()=>{e({activePresetId:"maximum",globalSettings:{...s.maximum},activeSleepPreset:null,scenarioOverrides:{},detectionZones:[...l],audioSettings:{frequencyRange:"all",backgroundNoiseFilter:!0,customLowFreq:20,customHighFreq:2e4},timingSettings:{cooldownPeriod:30,minimumMotionDuration:500,emergencyEscalationDelay:300},emergencyModeActive:!1,emergencyAlertId:null,globalMute:!1,customPresets:[]})}}),{name:"safeos-settings",storage:(0,n.FL)(()=>localStorage),partialize:e=>({activePresetId:e.activePresetId,activeSleepPreset:e.activeSleepPreset,globalSettings:e.globalSettings,scenarioOverrides:e.scenarioOverrides,detectionZones:e.detectionZones,audioSettings:e.audioSettings,timingSettings:e.timingSettings,globalMute:e.globalMute,customPresets:e.customPresets})}))}}]);