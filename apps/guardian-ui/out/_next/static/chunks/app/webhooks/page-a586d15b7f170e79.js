(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{78568:function(e,t,s){Promise.resolve().then(s.bind(s,63511))},63511:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var n=s(57437),r=s(2265),a=s(27648),o=s(96769),l=s(19065);function i(e){let{isOpen:t,onClose:s,onConfirm:a,title:o,message:l,confirmLabel:i="Confirm",cancelLabel:c="Cancel",variant:d="danger",isLoading:u=!1}=e,m=(0,r.useRef)(null),h=(0,r.useRef)(null);if((0,r.useEffect)(()=>{var e;if(!t)return;null===(e=h.current)||void 0===e||e.focus();let n=e=>{if("Escape"===e.key)s();else if("Tab"===e.key){let t=[h.current,m.current],s=t[0],n=t[t.length-1];e.shiftKey&&document.activeElement===s?(e.preventDefault(),null==n||n.focus()):e.shiftKey||document.activeElement!==n||(e.preventDefault(),null==s||s.focus())}};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[t,s]),(0,r.useEffect)(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),!t)return null;let x={danger:{icon:(0,n.jsx)("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),iconBg:"bg-red-500/20",confirmButton:"bg-red-600 hover:bg-red-700 focus:ring-red-500"},warning:{icon:(0,n.jsx)("svg",{className:"w-6 h-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),iconBg:"bg-yellow-500/20",confirmButton:"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500"},info:{icon:(0,n.jsx)("svg",{className:"w-6 h-6 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),iconBg:"bg-blue-500/20",confirmButton:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}}[d],f=async()=>{await a()};return(0,n.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title","aria-describedby":"confirm-dialog-message",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s,"aria-hidden":"true"}),(0,n.jsxs)("div",{className:"relative bg-slate-800 rounded-xl border border-slate-700 shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[(0,n.jsxs)("div",{className:"flex items-start gap-4",children:[(0,n.jsx)("div",{className:"p-3 rounded-full ".concat(x.iconBg),children:x.icon}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("h2",{id:"confirm-dialog-title",className:"text-lg font-semibold text-white",children:o}),(0,n.jsx)("p",{id:"confirm-dialog-message",className:"mt-2 text-sm text-slate-300",children:l})]})]}),(0,n.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,n.jsx)("button",{ref:h,onClick:s,disabled:u,className:"px-4 py-2 text-sm font-medium text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 focus:ring-offset-slate-800 disabled:opacity-50",children:c}),(0,n.jsx)("button",{ref:m,onClick:f,disabled:u,className:"px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-800 disabled:opacity-50 ".concat(x.confirmButton),children:u?(0,n.jsxs)("span",{className:"flex items-center gap-2",children:[(0,n.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Processing..."]}):i})]})]})]})}let c=[{id:"alert.created",label:"Alert Created",description:"When a new alert is generated"},{id:"alert.acknowledged",label:"Alert Acknowledged",description:"When an alert is acknowledged"},{id:"stream.started",label:"Stream Started",description:"When a monitoring stream starts"},{id:"stream.ended",label:"Stream Ended",description:"When a monitoring stream ends"},{id:"analysis.completed",label:"Analysis Completed",description:"When AI analysis finishes"},{id:"review.required",label:"Review Required",description:"When human review is needed"}];function d(){let{sessionToken:e,isAuthenticated:t,isInitialized:s}=(0,o.t)(),{success:d,error:u,info:m}=(0,l.pm)(),[h,x]=(0,r.useState)([]),[f,b]=(0,r.useState)(!0),[p,g]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null),[w,y]=(0,r.useState)({name:"",url:"",events:[]}),N="http://localhost:3001";(0,r.useEffect)(()=>{t&&k()},[t]);let k=async()=>{try{let t=await fetch("".concat(N,"/api/webhooks"),{headers:{"X-Session-Token":e||""}});if(t.ok){let e=await t.json();x(e.data||[])}}catch(e){u("Failed to load webhooks")}finally{b(!1)}},C=async t=>{if(t.preventDefault(),!w.name||!w.url||0===w.events.length){u("Please fill in all required fields");return}try{let t=await fetch("".concat(N,"/api/webhooks"),{method:"POST",headers:{"Content-Type":"application/json","X-Session-Token":e||""},body:JSON.stringify(w)});if(t.ok){let e=await t.json();x([...h,e.data]),y({name:"",url:"",events:[]}),g(!1),d("Webhook created!","Secret: ".concat(e.data.secret))}else{let e=await t.json();u(e.error||"Failed to create webhook")}}catch(e){u("Failed to create webhook")}},D=async()=>{if(v)try{(await fetch("".concat(N,"/api/webhooks/").concat(v),{method:"DELETE",headers:{"X-Session-Token":e||""}})).ok?(x(h.filter(e=>e.id!==v)),d("Webhook deleted")):u("Failed to delete webhook")}catch(e){u("Failed to delete webhook")}finally{j(null)}},E=async t=>{try{m("Sending test payload...");let s=await fetch("".concat(N,"/api/webhooks/").concat(t,"/test"),{method:"POST",headers:{"X-Session-Token":e||""}});if(s.ok)d("Test webhook sent successfully!");else{let e=await s.json();u(e.error||"Test failed")}}catch(e){u("Failed to send test")}},L=e=>{y(t=>({...t,events:t.events.includes(e)?t.events.filter(t=>t!==e):[...t.events,e]}))};return s?t?(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[(0,n.jsx)("header",{className:"p-4 sm:p-6 border-b border-slate-700/50",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(a.default,{href:"/settings",className:"text-slate-400 hover:text-white transition-colors",children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-xl font-bold text-white",children:"Webhooks"}),(0,n.jsx)("p",{className:"text-xs text-slate-400",children:"Custom integrations & notifications"})]})]}),(0,n.jsx)("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white rounded-lg font-medium hover:opacity-90 transition-opacity",children:"+ New Webhook"})]})}),(0,n.jsx)("div",{className:"max-w-4xl mx-auto p-4 sm:p-6",children:f?(0,n.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,n.jsx)("div",{className:"w-8 h-8 border-4 border-slate-600 border-t-emerald-500 rounded-full animate-spin"})}):0!==h.length||p?(0,n.jsxs)("div",{className:"space-y-6",children:[p&&(0,n.jsxs)("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Create New Webhook"}),(0,n.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),(0,n.jsx)("input",{type:"text",value:w.name,onChange:e=>y({...w,name:e.target.value}),placeholder:"My Integration",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Webhook URL"}),(0,n.jsx)("input",{type:"url",value:w.url,onChange:e=>y({...w,url:e.target.value}),placeholder:"https://your-app.com/webhook",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Events to Subscribe"}),(0,n.jsx)("div",{className:"grid sm:grid-cols-2 gap-2",children:c.map(e=>(0,n.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-colors ".concat(w.events.includes(e.id)?"bg-emerald-500/20 border-emerald-500/50":"bg-slate-700/50 border-slate-600 hover:border-slate-500"),children:[(0,n.jsx)("input",{type:"checkbox",checked:w.events.includes(e.id),onChange:()=>L(e.id),className:"mt-1 h-4 w-4 text-emerald-600 bg-slate-700 border-slate-600 rounded"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium text-white",children:e.label}),(0,n.jsx)("p",{className:"text-xs text-slate-400",children:e.description})]})]},e.id))})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,n.jsx)("button",{type:"button",onClick:()=>g(!1),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Cancel"}),(0,n.jsx)("button",{type:"submit",className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors",children:"Create Webhook"})]})]})]}),h.map(e=>(0,n.jsxs)("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.name}),(0,n.jsx)("p",{className:"text-sm text-slate-400 break-all",children:e.url})]}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:e.isActive?(0,n.jsx)("span",{className:"px-2 py-1 text-xs bg-emerald-500/20 text-emerald-400 rounded",children:"Active"}):(0,n.jsx)("span",{className:"px-2 py-1 text-xs bg-red-500/20 text-red-400 rounded",children:"Inactive"})})]}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:e.events.map(e=>(0,n.jsx)("span",{className:"px-2 py-1 text-xs bg-slate-700 text-slate-300 rounded",children:e},e))}),(0,n.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-slate-700/50",children:[(0,n.jsxs)("div",{className:"text-sm text-slate-500",children:[e.lastTriggered?"Last triggered: ".concat(new Date(e.lastTriggered).toLocaleDateString()):"Never triggered",e.failureCount>0&&(0,n.jsxs)("span",{className:"ml-2 text-orange-400",children:["(",e.failureCount," failures)"]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>E(e.id),className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded text-sm transition-colors",children:"Test"}),(0,n.jsx)("button",{onClick:()=>j(e.id),className:"px-3 py-1.5 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded text-sm transition-colors",children:"Delete"})]})]})]},e.id))]}):(0,n.jsxs)("div",{className:"text-center py-20",children:[(0,n.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-slate-800 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-3xl",children:"\uD83D\uDD17"})}),(0,n.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"No webhooks configured"}),(0,n.jsx)("p",{className:"text-slate-400 mb-6",children:"Set up webhooks to receive real-time notifications when events occur."}),(0,n.jsx)("button",{onClick:()=>g(!0),className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Create your first webhook"})]})}),(0,n.jsx)(i,{isOpen:!!v,onClose:()=>j(null),onConfirm:D,title:"Delete Webhook",message:"Are you sure you want to delete this webhook? This action cannot be undone.",confirmLabel:"Delete",variant:"danger"})]}):(0,n.jsx)("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Please log in"}),(0,n.jsx)(a.default,{href:"/",className:"text-emerald-400 hover:underline",children:"Go to Home"})]})}):(0,n.jsx)("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:(0,n.jsx)("div",{className:"w-8 h-8 border-4 border-slate-600 border-t-emerald-500 rounded-full animate-spin"})})}},19065:function(e,t,s){"use strict";s.d(t,{CF:function(){return l},pm:function(){return a}}),s(57437);var n=s(2265);let r=(0,n.createContext)(void 0);function a(){let e=(0,n.useContext)(r);if(!e){let e=()=>{};return{toasts:[],addToast:e,removeToast:e,success:e,error:e,warning:e,info:e}}return e}let o=new Set;function l(e){o.forEach(t=>t(e)),0===o.size&&console.log("[Toast:".concat(e.type||"info","] ").concat(e.message))}},21542:function(e,t,s){"use strict";let n,r,a;s.d(t,{X3:function(){return f}});let o=(e,t)=>t.some(t=>e instanceof t),l=new WeakMap,i=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,m={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return i.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return h(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,s)=>{let n=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{t(h(e.result)),n()},a=()=>{s(e.error),n()};e.addEventListener("success",r),e.addEventListener("error",a)});return t.then(t=>{t instanceof IDBCursor&&l.set(t,e)}).catch(()=>{}),u.set(t,e),t}(e);if(d.has(e))return d.get(e);let s="function"==typeof(t=e)?t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(x(this),e),h(l.get(this))}:function(...e){return h(t.apply(x(this),e))}:function(e,...s){let n=t.call(x(this),e,...s);return c.set(n,e.sort?e.sort():[e]),h(n)}:(t instanceof IDBTransaction&&function(e){if(i.has(e))return;let t=new Promise((t,s)=>{let n=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{t(),n()},a=()=>{s(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)});i.set(e,t)}(t),o(t,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,m):t;return s!==e&&(d.set(e,s),u.set(s,e)),s}let x=e=>u.get(e);function f(e,t,{blocked:s,upgrade:n,blocking:r,terminated:a}={}){let o=indexedDB.open(e,t),l=h(o);return n&&o.addEventListener("upgradeneeded",e=>{n(h(o.result),e.oldVersion,e.newVersion,h(o.transaction),e)}),s&&o.addEventListener("blocked",e=>s(e.oldVersion,e.newVersion,e)),l.then(e=>{a&&e.addEventListener("close",()=>a()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),l}let b=["get","getKey","getAll","getAllKeys","count"],p=["put","add","delete","clear"],g=new Map;function v(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(g.get(t))return g.get(t);let s=t.replace(/FromIndex$/,""),n=t!==s,r=p.includes(s);if(!(s in(n?IDBIndex:IDBObjectStore).prototype)||!(r||b.includes(s)))return;let a=async function(e,...t){let a=this.transaction(e,r?"readwrite":"readonly"),o=a.store;return n&&(o=o.index(t.shift())),(await Promise.all([o[s](...t),r&&a.done]))[0]};return g.set(t,a),a}m={...a=m,get:(e,t,s)=>v(e,t)||a.get(e,t,s),has:(e,t)=>!!v(e,t)||a.has(e,t)}}},function(e){e.O(0,[648,883,769,971,117,744],function(){return e(e.s=78568)}),_N_E=e.O()}]);