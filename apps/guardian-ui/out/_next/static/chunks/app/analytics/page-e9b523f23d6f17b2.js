(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{60693:function(e,t,a){Promise.resolve().then(a.bind(a,64520))},64520:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var o=a(57437),r=a(2265),s=a(96769),l=a(99376),n=a(47625),i=a(5481),c=a(56940),d=a(97059),h=a(62994),x=a(8147),m=a(22190),u=a(23263);function b(e){let{data:t,dataKeys:a,xAxisKey:r,height:s=300,showGrid:l=!0,showLegend:b=!0,gradientFill:f=!0}=e;return(0,o.jsx)(n.h,{width:"100%",height:s,children:(0,o.jsxs)(i.T,{data:t,margin:{top:10,right:30,left:0,bottom:0},children:[(0,o.jsx)("defs",{children:a.map(e=>(0,o.jsxs)("linearGradient",{id:"gradient-".concat(e.key),x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,o.jsx)("stop",{offset:"5%",stopColor:e.color,stopOpacity:.8}),(0,o.jsx)("stop",{offset:"95%",stopColor:e.color,stopOpacity:0})]},e.key))}),l&&(0,o.jsx)(c.q,{strokeDasharray:"3 3",stroke:"#334155"}),(0,o.jsx)(d.K,{dataKey:r,stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:{stroke:"#334155"}}),(0,o.jsx)(h.B,{stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:{stroke:"#334155"}}),(0,o.jsx)(x.u,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px",color:"#f8fafc"},labelStyle:{color:"#94a3b8"}}),b&&(0,o.jsx)(m.D,{wrapperStyle:{color:"#94a3b8"}}),a.map(e=>{var t;return(0,o.jsx)(u.u,{type:"monotone",dataKey:e.key,name:e.name,stroke:e.color,fill:f?"url(#gradient-".concat(e.key,")"):e.color,fillOpacity:null!==(t=e.fillOpacity)&&void 0!==t?t:1,strokeWidth:2},e.key)})]})})}var f=a(77031),g=a(31699),y=a(20407);let j=["#10b981","#06b6d4","#8b5cf6","#f97316","#ef4444","#eab308","#3b82f6","#ec4899"];function p(e){let{data:t,dataKey:a,nameKey:r,height:s=300,showGrid:l=!0,showLegend:i=!1,horizontal:u=!1,colors:b=j,defaultColor:p="#10b981",barRadius:v=4}=e,k=u?(0,o.jsxs)(f.v,{layout:"vertical",data:t,margin:{top:10,right:30,left:80,bottom:0},children:[l&&(0,o.jsx)(c.q,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),(0,o.jsx)(d.K,{type:"number",stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:{stroke:"#334155"}}),(0,o.jsx)(h.B,{type:"category",dataKey:r,stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:{stroke:"#334155"},width:70}),(0,o.jsx)(x.u,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px",color:"#f8fafc"},cursor:{fill:"rgba(255,255,255,0.05)"}}),i&&(0,o.jsx)(m.D,{}),(0,o.jsx)(g.$,{dataKey:a,radius:[0,v,v,0],children:t.map((e,t)=>(0,o.jsx)(y.b,{fill:b[t%b.length]||p},"cell-".concat(t)))})]}):(0,o.jsxs)(f.v,{data:t,margin:{top:10,right:30,left:0,bottom:0},children:[l&&(0,o.jsx)(c.q,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),(0,o.jsx)(d.K,{dataKey:r,stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:{stroke:"#334155"}}),(0,o.jsx)(h.B,{stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:{stroke:"#334155"}}),(0,o.jsx)(x.u,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px",color:"#f8fafc"},cursor:{fill:"rgba(255,255,255,0.05)"}}),i&&(0,o.jsx)(m.D,{}),(0,o.jsx)(g.$,{dataKey:a,radius:[v,v,0,0],children:t.map((e,t)=>(0,o.jsx)(y.b,{fill:b[t%b.length]||p},"cell-".concat(t)))})]});return(0,o.jsx)(n.h,{width:"100%",height:s,children:k})}var v=a(75169),k=a(3574);let N=["#10b981","#06b6d4","#8b5cf6","#f97316","#ef4444","#eab308","#3b82f6","#ec4899"];function w(e){let{data:t,height:a=300,showLegend:r=!0,donut:s=!1,innerRadius:l=60,outerRadius:i=80,label:c=!1,labelLine:d=!1}=e;return(0,o.jsx)(n.h,{width:"100%",height:a,children:(0,o.jsxs)(v.u,{children:[(0,o.jsx)(k.b,{data:t,cx:"50%",cy:"50%",innerRadius:s?l:0,outerRadius:i,paddingAngle:s?3:0,dataKey:"value",label:c?e=>{let{cx:t,cy:a,midAngle:r,innerRadius:s,outerRadius:l,percent:n,name:i}=e,c=Math.PI/180,d=s+(l-s)*1.4,h=t+d*Math.cos(-r*c);return n<.05?null:(0,o.jsx)("text",{x:h,y:a+d*Math.sin(-r*c),fill:"#94a3b8",textAnchor:h>t?"start":"end",dominantBaseline:"central",fontSize:12,children:"".concat(i," (").concat((100*n).toFixed(0),"%)")})}:void 0,labelLine:d,children:t.map((e,t)=>(0,o.jsx)(y.b,{fill:e.color||N[t%N.length]},"cell-".concat(t)))}),(0,o.jsx)(x.u,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px",color:"#f8fafc"},formatter:e=>[e,""]}),r&&(0,o.jsx)(m.D,{layout:"horizontal",verticalAlign:"bottom",align:"center",wrapperStyle:{color:"#94a3b8",paddingTop:"20px"}})]})})}var S=a(21156),D=a(54061);function M(e){let{data:t,lines:a,xAxisKey:r,height:s=300,showGrid:l=!0,showLegend:i=!0,showDots:u=!0,curved:b=!0}=e;return(0,o.jsx)(n.h,{width:"100%",height:s,children:(0,o.jsxs)(S.w,{data:t,margin:{top:10,right:30,left:0,bottom:0},children:[l&&(0,o.jsx)(c.q,{strokeDasharray:"3 3",stroke:"#334155"}),(0,o.jsx)(d.K,{dataKey:r,stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:{stroke:"#334155"}}),(0,o.jsx)(h.B,{stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:{stroke:"#334155"}}),(0,o.jsx)(x.u,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px",color:"#f8fafc"},labelStyle:{color:"#94a3b8"}}),i&&(0,o.jsx)(m.D,{wrapperStyle:{color:"#94a3b8"}}),a.map(e=>(0,o.jsx)(D.x,{type:b?"monotone":"linear",dataKey:e.key,name:e.name,stroke:e.color,strokeWidth:e.strokeWidth||2,strokeDasharray:e.dashed?"5 5":void 0,dot:!!u&&{fill:e.color,strokeWidth:2},activeDot:{r:6,fill:e.color}},e.key))]})})}var A=a(19065);function L(e){let t="24h"===e?24:"7d"===e?7:"30d"===e?30:90,a=Array.from({length:t},(a,o)=>{let r=new Date;return r.setDate(r.getDate()-(t-o-1)),{date:"24h"===e?"".concat(String(o).padStart(2,"0"),":00"):r.toLocaleDateString("en-US",{month:"short",day:"numeric"}),critical:Math.floor(3*Math.random()),high:Math.floor(8*Math.random()),medium:Math.floor(15*Math.random()),low:Math.floor(25*Math.random()),total:0}});a.forEach(e=>{e.total=e.critical+e.high+e.medium+e.low});let o=a.reduce((e,t)=>e+t.total,0);return{overview:{totalAlerts:o,totalStreams:Math.floor(50*Math.random())+10,totalHours:Math.floor(500*Math.random())+50,localAiUsage:75+20*Math.random(),cloudFallbackRate:5+15*Math.random(),avgResponseTime:150+100*Math.random()},alertsOverTime:a,alertsBySeverity:[{name:"Critical",value:a.reduce((e,t)=>e+t.critical,0),color:"#ef4444"},{name:"High",value:a.reduce((e,t)=>e+t.high,0),color:"#f97316"},{name:"Medium",value:a.reduce((e,t)=>e+t.medium,0),color:"#eab308"},{name:"Low",value:a.reduce((e,t)=>e+t.low,0),color:"#3b82f6"}],alertsByScenario:[{scenario:"Pet",count:Math.floor(.4*o)},{scenario:"Baby",count:Math.floor(.35*o)},{scenario:"Elderly",count:Math.floor(.25*o)}],hourlyActivity:Array.from({length:24},(e,t)=>({hour:"".concat(String(t).padStart(2,"0"),":00"),motion:Math.floor(100*Math.random()),audio:Math.floor(60*Math.random()),alerts:Math.floor(10*Math.random())})),streamDuration:Array.from({length:Math.min(t,30)},(e,a)=>{let o=new Date;return o.setDate(o.getDate()-(t-a-1)),{date:o.toLocaleDateString("en-US",{month:"short",day:"numeric"}),minutes:Math.floor(480*Math.random())+60}}),aiPerformance:Array.from({length:Math.min(t,14)},(e,t)=>{let a=new Date;return a.setDate(a.getDate()-(14-t-1)),{date:a.toLocaleDateString("en-US",{month:"short",day:"numeric"}),localMs:100+150*Math.random(),cloudMs:300+400*Math.random(),accuracy:85+12*Math.random()}})}}function C(){let{isAuthenticated:e,isLoading:t,isInitialized:a}=(0,s.t)(),n=(0,l.useRouter)(),[i,c]=(0,r.useState)(null),[d,h]=(0,r.useState)(!0),[x,m]=(0,r.useState)(null),[u,f]=(0,r.useState)("7d"),g="http://localhost:3001",y=(0,r.useCallback)(async()=>{h(!0),m(null);try{let e=await fetch("".concat(g,"/api/analytics?range=").concat(u));e.ok?c(await e.json()):c(L(u))}catch(e){c(L(u))}finally{h(!1)}},[g,u]);return((0,r.useEffect)(()=>{t||!a||e?e&&y():n.push("/")},[e,t,a,n,y]),t||!a)?(0,o.jsx)("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:(0,o.jsx)("div",{className:"w-16 h-16 border-4 border-slate-700 border-t-emerald-500 rounded-full animate-spin"})}):x?(0,o.jsxs)("div",{className:"min-h-screen bg-slate-900 text-white p-8 text-center",children:[(0,o.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Error"}),(0,o.jsxs)("p",{className:"text-lg text-red-400",children:["Failed to load analytics: ",x]}),(0,o.jsx)("button",{onClick:y,className:"mt-4 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg",children:"Retry"})]}):e?(0,o.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white p-8",children:[(0,o.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-4xl font-bold",children:"Analytics Dashboard"}),(0,o.jsx)("p",{className:"text-slate-400 mt-1",children:"Insights and trends from your monitoring sessions"})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsxs)("select",{value:u,onChange:e=>f(e.target.value),className:"bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white focus:ring-emerald-500 focus:border-emerald-500",children:[(0,o.jsx)("option",{value:"24h",children:"Last 24 Hours"}),(0,o.jsx)("option",{value:"7d",children:"Last 7 Days"}),(0,o.jsx)("option",{value:"30d",children:"Last 30 Days"}),(0,o.jsx)("option",{value:"90d",children:"Last 90 Days"}),(0,o.jsx)("option",{value:"all",children:"All Time"})]}),(0,o.jsx)("button",{onClick:y,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:"Refresh"})]})]}),d?(0,o.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,o.jsx)("div",{className:"w-12 h-12 border-4 border-slate-700 border-t-emerald-500 rounded-full animate-spin"})}):i?(0,o.jsxs)("div",{className:"space-y-8",children:[(0,o.jsxs)("section",{children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Overview"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,o.jsx)(K,{label:"Total Alerts",value:i.overview.totalAlerts,icon:"\uD83D\uDEA8"}),(0,o.jsx)(K,{label:"Active Streams",value:i.overview.totalStreams,icon:"\uD83D\uDCF9"}),(0,o.jsx)(K,{label:"Hours Monitored",value:"".concat(i.overview.totalHours,"h"),icon:"⏱️"}),(0,o.jsx)(K,{label:"Local AI Usage",value:"".concat(i.overview.localAiUsage.toFixed(1),"%"),icon:"\uD83E\uDD16",highlight:i.overview.localAiUsage>80}),(0,o.jsx)(K,{label:"Cloud Fallback",value:"".concat(i.overview.cloudFallbackRate.toFixed(1),"%"),icon:"☁️",highlight:i.overview.cloudFallbackRate<10}),(0,o.jsx)(K,{label:"Avg Response",value:"".concat(i.overview.avgResponseTime.toFixed(0),"ms"),icon:"⚡"})]})]}),(0,o.jsxs)("section",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,o.jsxs)("div",{className:"lg:col-span-2 bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Alerts Over Time"}),(0,o.jsx)(b,{data:i.alertsOverTime,dataKeys:[{key:"critical",name:"Critical",color:"#ef4444"},{key:"high",name:"High",color:"#f97316"},{key:"medium",name:"Medium",color:"#eab308"},{key:"low",name:"Low",color:"#3b82f6"}],xAxisKey:"date",height:300})]}),(0,o.jsxs)("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Alerts by Severity"}),(0,o.jsx)(w,{data:i.alertsBySeverity,height:300,donut:!0})]})]}),(0,o.jsxs)("section",{className:"bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Hourly Activity Pattern"}),(0,o.jsx)(M,{data:i.hourlyActivity,lines:[{key:"motion",name:"Motion Events",color:"#10b981"},{key:"audio",name:"Audio Events",color:"#06b6d4"},{key:"alerts",name:"Alerts",color:"#ef4444",dashed:!0}],xAxisKey:"hour",height:250})]}),(0,o.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,o.jsxs)("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Alerts by Scenario"}),(0,o.jsx)(p,{data:i.alertsByScenario,dataKey:"count",nameKey:"scenario",height:250,colors:["#f59e0b","#ec4899","#8b5cf6"]})]}),(0,o.jsxs)("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Stream Duration (minutes)"}),(0,o.jsx)(p,{data:i.streamDuration,dataKey:"minutes",nameKey:"date",height:250,defaultColor:"#10b981"})]})]}),(0,o.jsxs)("section",{className:"bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"AI Performance"}),(0,o.jsx)(M,{data:i.aiPerformance,lines:[{key:"localMs",name:"Local AI (ms)",color:"#10b981"},{key:"cloudMs",name:"Cloud AI (ms)",color:"#f97316"}],xAxisKey:"date",height:250}),(0,o.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Lower response times indicate better performance. Local AI is typically 2-3x faster than cloud."})]}),(0,o.jsx)("section",{className:"flex justify-end gap-4",children:(0,o.jsxs)("button",{onClick:()=>{let e=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="safeos-analytics-".concat(u,".json"),a.click(),URL.revokeObjectURL(t),(0,A.CF)({message:"Analytics exported!",type:"success"})},className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors flex items-center gap-2",children:[(0,o.jsx)("span",{children:"\uD83D\uDCE5"}),"Export JSON"]})})]}):(0,o.jsx)("div",{className:"text-center text-slate-400 py-8",children:(0,o.jsx)("p",{children:"No analytics data available."})})]}):null}function K(e){let{label:t,value:a,icon:r,highlight:s=!1}=e;return(0,o.jsxs)("div",{className:"bg-slate-800/50 rounded-xl border p-4 ".concat(s?"border-emerald-500/50":"border-slate-700/50"),children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsx)("span",{className:"text-2xl",children:r}),s&&(0,o.jsx)("span",{className:"text-emerald-400 text-xs",children:"✓ Good"})]}),(0,o.jsx)("p",{className:"text-2xl font-bold text-white",children:a}),(0,o.jsx)("p",{className:"text-xs text-slate-400",children:t})]})}},19065:function(e,t,a){"use strict";a.d(t,{CF:function(){return n},pm:function(){return s}}),a(57437);var o=a(2265);let r=(0,o.createContext)(void 0);function s(){let e=(0,o.useContext)(r);if(!e){let e=()=>{};return{toasts:[],addToast:e,removeToast:e,success:e,error:e,warning:e,info:e}}return e}let l=new Set;function n(e){l.forEach(t=>t(e)),0===l.size&&console.log("[Toast:".concat(e.type||"info","] ").concat(e.message))}}},function(e){e.O(0,[883,227,769,971,117,744],function(){return e(e.s=60693)}),_N_E=e.O()}]);