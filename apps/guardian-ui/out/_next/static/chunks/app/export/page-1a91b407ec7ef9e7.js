(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[649],{35981:function(e,t,s){Promise.resolve().then(s.bind(s,5708))},5708:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=s(57437),n=s(2265),a=s(27648),o=s(96769),i=s(19065);let l=[{id:"alerts",label:"Alerts",description:"All alerts with timestamps, severity, and messages",icon:"\uD83D\uDD14",formats:["json","csv"]},{id:"analysis",label:"AI Analysis Results",description:"Analysis results, concern levels, and processing times",icon:"\uD83D\uDD0D",formats:["json","csv"]},{id:"streams",label:"Stream History",description:"All monitoring sessions with stats",icon:"\uD83D\uDCF9",formats:["json","csv"]},{id:"profile",label:"Profile & Settings",description:"Your profile, preferences, and notification settings",icon:"\uD83D\uDC64",formats:["json"]},{id:"all",label:"Full Data Export",description:"Complete data export (GDPR compliant)",icon:"\uD83D\uDCE6",formats:["json"]}];function c(){let{sessionToken:e,isAuthenticated:t,isInitialized:s}=(0,o.t)(),{success:c,error:d,info:m}=(0,i.pm)(),[u,x]=(0,n.useState)("alerts"),[p,h]=(0,n.useState)("json"),[f,b]=(0,n.useState)({start:"",end:""}),[g,v]=(0,n.useState)(!1),j=async()=>{v(!0),m("Preparing export...");try{let t=new URLSearchParams;t.append("format",p),f.start&&t.append("startDate",f.start),f.end&&t.append("endDate",f.end);let s=await fetch("".concat("http://localhost:3001","/api/export/").concat(u,"?").concat(t.toString()),{headers:{"X-Session-Token":e||""}});if(!s.ok)throw Error("Export failed");let r=s.headers.get("Content-Disposition"),n="safeos-".concat(u,"-").concat(new Date().toISOString().split("T")[0],".").concat(p);if(r){let e=r.match(/filename="(.+)"/);e&&(n=e[1])}let a=await s.blob(),o=window.URL.createObjectURL(a),i=document.createElement("a");i.href=o,i.download=n,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(o),document.body.removeChild(i),c("Export complete!","Downloaded ".concat(n))}catch(e){d("Export failed","Please try again later")}finally{v(!1)}},w=l.find(e=>e.id===u);return s?t?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[(0,r.jsx)("header",{className:"p-4 sm:p-6 border-b border-slate-700/50",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto flex items-center gap-4",children:[(0,r.jsx)(a.default,{href:"/settings",className:"text-slate-400 hover:text-white transition-colors",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-white",children:"Export Data"}),(0,r.jsx)("p",{className:"text-xs text-slate-400",children:"Download your monitoring data"})]})]})}),(0,r.jsxs)("div",{className:"max-w-3xl mx-auto p-4 sm:p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"What to Export"}),(0,r.jsx)("div",{className:"grid sm:grid-cols-2 gap-3",children:l.map(e=>(0,r.jsxs)("button",{onClick:()=>{x(e.id),e.formats.includes(p)||h(e.formats[0])},className:"p-4 rounded-lg border text-left transition-colors ".concat(u===e.id?"bg-emerald-500/20 border-emerald-500/50":"bg-slate-700/50 border-slate-600 hover:border-slate-500"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,r.jsx)("span",{className:"text-2xl",children:e.icon}),(0,r.jsx)("span",{className:"font-medium text-white",children:e.label})]}),(0,r.jsx)("p",{className:"text-sm text-slate-400",children:e.description})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700/50 p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Export Options"}),(0,r.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Format"}),(0,r.jsx)("div",{className:"flex gap-2",children:null==w?void 0:w.formats.map(e=>(0,r.jsx)("button",{onClick:()=>h(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(p===e?"bg-emerald-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:e.toUpperCase()},e))})]}),["alerts","analysis"].includes(u)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Start Date"}),(0,r.jsx)("input",{type:"date",value:f.start,onChange:e=>b({...f,start:e.target.value}),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"End Date"}),(0,r.jsx)("input",{type:"date",value:f.end,onChange:e=>b({...f,end:e.target.value}),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white"})]})]})]})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{onClick:j,disabled:g,className:"px-6 py-3 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Exporting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download Export"]})})}),(0,r.jsx)("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-blue-400",children:"ℹ️"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-blue-300 mb-1",children:"Your Data, Your Control"}),(0,r.jsx)("p",{className:"text-sm text-slate-400",children:'Exports include all data associated with your account. The "Full Data Export" option provides a complete download of all your information as required by GDPR and CCPA regulations.'})]})]})})]})]}):(0,r.jsx)("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Please log in"}),(0,r.jsx)(a.default,{href:"/",className:"text-emerald-400 hover:underline",children:"Go to Home"})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-8 h-8 border-4 border-slate-600 border-t-emerald-500 rounded-full animate-spin"})})}},19065:function(e,t,s){"use strict";s.d(t,{CF:function(){return i},pm:function(){return a}}),s(57437);var r=s(2265);let n=(0,r.createContext)(void 0);function a(){let e=(0,r.useContext)(n);if(!e){let e=()=>{};return{toasts:[],addToast:e,removeToast:e,success:e,error:e,warning:e,info:e}}return e}let o=new Set;function i(e){o.forEach(t=>t(e)),0===o.size&&console.log("[Toast:".concat(e.type||"info","] ").concat(e.message))}},21542:function(e,t,s){"use strict";let r,n,a;s.d(t,{X3:function(){return h}});let o=(e,t)=>t.some(t=>e instanceof t),i=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,m=new WeakMap,u={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return l.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return x(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function x(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,s)=>{let r=()=>{e.removeEventListener("success",n),e.removeEventListener("error",a)},n=()=>{t(x(e.result)),r()},a=()=>{s(e.error),r()};e.addEventListener("success",n),e.addEventListener("error",a)});return t.then(t=>{t instanceof IDBCursor&&i.set(t,e)}).catch(()=>{}),m.set(t,e),t}(e);if(d.has(e))return d.get(e);let s="function"==typeof(t=e)?t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(n||(n=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(p(this),e),x(i.get(this))}:function(...e){return x(t.apply(p(this),e))}:function(e,...s){let r=t.call(p(this),e,...s);return c.set(r,e.sort?e.sort():[e]),x(r)}:(t instanceof IDBTransaction&&function(e){if(l.has(e))return;let t=new Promise((t,s)=>{let r=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",a),e.removeEventListener("abort",a)},n=()=>{t(),r()},a=()=>{s(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",n),e.addEventListener("error",a),e.addEventListener("abort",a)});l.set(e,t)}(t),o(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,u):t;return s!==e&&(d.set(e,s),m.set(s,e)),s}let p=e=>m.get(e);function h(e,t,{blocked:s,upgrade:r,blocking:n,terminated:a}={}){let o=indexedDB.open(e,t),i=x(o);return r&&o.addEventListener("upgradeneeded",e=>{r(x(o.result),e.oldVersion,e.newVersion,x(o.transaction),e)}),s&&o.addEventListener("blocked",e=>s(e.oldVersion,e.newVersion,e)),i.then(e=>{a&&e.addEventListener("close",()=>a()),n&&e.addEventListener("versionchange",e=>n(e.oldVersion,e.newVersion,e))}).catch(()=>{}),i}let f=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],g=new Map;function v(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(g.get(t))return g.get(t);let s=t.replace(/FromIndex$/,""),r=t!==s,n=b.includes(s);if(!(s in(r?IDBIndex:IDBObjectStore).prototype)||!(n||f.includes(s)))return;let a=async function(e,...t){let a=this.transaction(e,n?"readwrite":"readonly"),o=a.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[s](...t),n&&a.done]))[0]};return g.set(t,a),a}u={...a=u,get:(e,t,s)=>v(e,t)||a.get(e,t,s),has:(e,t)=>!!v(e,t)||a.has(e,t)}}},function(e){e.O(0,[648,883,769,971,117,744],function(){return e(e.s=35981)}),_N_E=e.O()}]);