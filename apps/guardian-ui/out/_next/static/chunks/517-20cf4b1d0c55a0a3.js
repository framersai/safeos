"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[517],{79286:function(e,t,r){r.d(t,{sO:function(){return a}});var n=r(2265);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{onMessage:r,onConnect:a,onDisconnect:s,onError:l,reconnect:i=!0,reconnectDelay:c=3e3,maxReconnectAttempts:o=10}=t,u=(0,n.useRef)(null),d=(0,n.useRef)(0),m=(0,n.useRef)(null),p=(0,n.useRef)(null),[S,b]=(0,n.useState)(!1),[g,f]=(0,n.useState)(null),v=(0,n.useCallback)(()=>{var t;if((null===(t=u.current)||void 0===t?void 0:t.readyState)!==WebSocket.OPEN)try{let t=new WebSocket(e);u.current=t,t.onopen=()=>{b(!0),d.current=0,null==a||a(),m.current=setInterval(()=>{t.readyState===WebSocket.OPEN&&t.send(JSON.stringify({type:"ping"}))},3e4)},t.onmessage=e=>{try{let t=JSON.parse(e.data);f(t),null==r||r(t)}catch(e){console.error("Failed to parse WebSocket message:",e)}},t.onclose=()=>{if(b(!1),null==s||s(),m.current&&(clearInterval(m.current),m.current=null),i&&d.current<o){d.current++;let e=c*Math.pow(1.5,d.current-1);p.current=setTimeout(v,Math.min(e,3e4))}},t.onerror=e=>{null==l||l(e)}}catch(e){console.error("WebSocket connection error:",e)}},[e,a,s,r,l,i,c,o]),C=(0,n.useCallback)(()=>{p.current&&clearTimeout(p.current),m.current&&clearInterval(m.current),u.current&&(u.current.close(),u.current=null),b(!1)},[]),h=(0,n.useCallback)(e=>{var t;(null===(t=u.current)||void 0===t?void 0:t.readyState)===WebSocket.OPEN&&u.current.send(JSON.stringify({...e,timestamp:Date.now()}))},[]),E=(0,n.useCallback)(e=>{h({type:"subscribe",channel:e})},[h]),y=(0,n.useCallback)(e=>{h({type:"unsubscribe",channel:e})},[h]),k=(0,n.useCallback)((e,t,r,n)=>{h({type:"frame",streamId:e,payload:{imageData:t,motionScore:r,audioLevel:n}})},[h]);return(0,n.useEffect)(()=>(v(),()=>{C()}),[v,C]),{isConnected:S,lastMessage:g,sendMessage:h,subscribe:E,unsubscribe:y,sendFrame:k,connect:v,disconnect:C}}},54426:function(e,t,r){r.d(t,{m5:function(){return l}});var n=r(59625),a=r(89134);let s={motionSensitivity:50,audioSensitivity:50,analysisInterval:30,enableMotionDetection:!0,enableAudioDetection:!0,enableCryDetection:!0,muted:!1},l=(0,n.Ue)()((0,a.tJ)((e,t)=>({isConnected:!1,isStreaming:!1,streamId:null,scenario:null,streams:[],motionScore:0,audioLevel:0,hasCrying:!1,alerts:[],settings:s,setConnected:t=>e({isConnected:t}),setStreaming:t=>e({isStreaming:t}),setStreamId:t=>e({streamId:t}),setScenario:t=>e({scenario:t}),setMotionScore:t=>e({motionScore:t}),setAudioLevel:t=>e({audioLevel:t}),setHasCrying:t=>e({hasCrying:t}),addAlert:t=>e(e=>({alerts:[t,...e.alerts].slice(0,100)})),removeAlert:t=>e(e=>({alerts:e.alerts.filter(e=>e.id!==t)})),acknowledgeAlert:t=>e(e=>({alerts:e.alerts.map(e=>e.id===t?{...e,acknowledged:!0}:e)})),clearAlerts:()=>e({alerts:[]}),addStream:t=>e(e=>({streams:[...e.streams,t]})),removeStream:t=>e(e=>({streams:e.streams.filter(e=>e.id!==t)})),updateStream:(t,r)=>e(e=>({streams:e.streams.map(e=>e.id===t?{...e,...r}:e)})),updateSettings:t=>e(e=>({settings:{...e.settings,...t}})),reset:()=>e({isStreaming:!1,streamId:null,scenario:null,streams:[],motionScore:0,audioLevel:0,hasCrying:!1,alerts:[],settings:s})}),{name:"safeos-monitoring",partialize:e=>({settings:e.settings})}))},4542:function(e,t,r){r.d(t,{pZ:function(){return i},w1:function(){return l}});var n=r(59625),a=r(89134);let s={main:!1,scenario:!1,privacy:!1,terms:!1},l=(0,n.Ue)()((0,a.tJ)((e,t)=>({currentStep:0,completedSteps:[],isComplete:!1,acceptedDisclaimers:s,disclaimerAcceptedAt:null,selectedScenario:null,profileName:"",notificationsEnabled:!0,browserPushEnabled:!1,smsEnabled:!1,telegramEnabled:!1,telegramChatId:null,cameraPermissionGranted:!1,microphonePermissionGranted:!1,setStep:t=>e({currentStep:t}),completeStep:t=>e(e=>({completedSteps:e.completedSteps.includes(t)?e.completedSteps:[...e.completedSteps,t],currentStep:Math.max(e.currentStep,t+1)})),setComplete:t=>e({isComplete:t}),acceptDisclaimer:t=>e(e=>({acceptedDisclaimers:{...e.acceptedDisclaimers,[t]:!0},disclaimerAcceptedAt:new Date().toISOString()})),acceptAllDisclaimers:()=>e({acceptedDisclaimers:{main:!0,scenario:!0,privacy:!0,terms:!0},disclaimerAcceptedAt:new Date().toISOString()}),setScenario:t=>e({selectedScenario:t}),setProfileName:t=>e({profileName:t}),setNotifications:t=>e(e=>{var r,n,a,s,l;return{notificationsEnabled:null!==(r=t.notificationsEnabled)&&void 0!==r?r:e.notificationsEnabled,browserPushEnabled:null!==(n=t.browserPushEnabled)&&void 0!==n?n:e.browserPushEnabled,smsEnabled:null!==(a=t.smsEnabled)&&void 0!==a?a:e.smsEnabled,telegramEnabled:null!==(s=t.telegramEnabled)&&void 0!==s?s:e.telegramEnabled,telegramChatId:null!==(l=t.telegramChatId)&&void 0!==l?l:e.telegramChatId}}),setCameraPermission:t=>e({cameraPermissionGranted:t}),setMicrophonePermission:t=>e({microphonePermissionGranted:t}),reset:()=>e({currentStep:0,completedSteps:[],isComplete:!1,acceptedDisclaimers:s,disclaimerAcceptedAt:null,selectedScenario:null,profileName:"",notificationsEnabled:!0,browserPushEnabled:!1,smsEnabled:!1,telegramEnabled:!1,telegramChatId:null,cameraPermissionGranted:!1,microphonePermissionGranted:!1})}),{name:"safeos-onboarding"}));function i(e){var t;return e.isComplete&&(t=e.acceptedDisclaimers).main&&t.scenario&&null!==e.selectedScenario}}}]);